<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
  <meta charset="UTF-8">
  <title>Books Store Checkout</title>
  <link rel="icon" type="image/png" th:href="@{/icons8-library-96.png}"/>
  <link rel="stylesheet" th:href="@{/css/main.css}"/>
  <link rel="stylesheet" th:href="@{/css/index.css}"/>
  <link rel="stylesheet" th:href="@{/css/checkout.css}"/>
</head>
<body>

<div id="navbar-root" 
     th:data-user-role="${#authorization.expression('hasRole(''ADMIN'')') ? 'ADMIN' : (#authorization.expression('hasRole(''USER'')') ? 'USER' : 'GUEST')}">
     th:data-is-authenticated="${#authorization.expression('isAuthenticated()')}"
     th:data-csrf-token="${_csrf.token}">
</div>


<div class="checkout-wrapper">
  <form class="checkout-form" th:action="@{/placeOrder}" method="post">
    <h2>Checkout</h2>

    <div class="form-section">
      <h3 style="text-align: center">Billing Information</h3>

      <div class="form-group">
        <label>Name</label>
        <p class="form-value" th:text="${user.getName()}">John</p>
      </div>

      <div class="form-group">
        <label>Surname</label>
        <p class="form-value" th:text="${user.getSurname()}">Doe</p>
      </div>

      <div class="form-group">
        <label>Email Address</label>
        <p class="form-value" th:text="${user.getEmailAddress()}">cristian@ucd.ie</p>
      </div>

      <div class="form-group">
        <label>Address</label>
        <p class="form-value" th:text="${user.getAddress()}">123 Main St</p>
      </div>

      <div class="form-group">
        <label>Date of Birth</label>
        <p class="form-value" th:text="${user.getDateOfBirth()}">01.01.2001</p>
      </div>

      <div class="form-group">
        <label>Phone Number</label>
        <p class="form-value" th:text="${user.getPhoneNumber()}">000-0000000</p>
      </div>

      <div class="form-group">
        <label for="cardNumber">Card Number</label>
        <input
                type="text"
                class="form-value"
                id="cardNumber"
                name="cardNumber"
                minlength="16"
                maxlength="19"
                pattern="\d{16,19}"
                placeholder="Card Number"
                autocomplete="cc-number"
                required
                inputmode="numeric"
                title="Card number must be 16 to 19 digits"
        >
      </div>

      <div class="form-group">
        <label for="cardOwner">Card Owner</label>
        <input
                type="text"
                class="form-value"
                id="cardOwner"
                name="cardOwner"
                maxlength="50"
                pattern="[A-Za-z\s]+"
                placeholder="Card Owner"
                autocomplete="cc-owner"
                required
                title="Card owner must contain only letters and spaces"
        >
      </div>

      <div class="form-group">
        <label for="expirationDate">Expiration Date</label>
        <input
                type="text"
                class="form-value"
                id="expirationDate"
                name="expirationDate"
                maxlength="5"
                pattern="(0[1-9]|1[0-2])\/\d{2}"
                placeholder="MM/YY"
                autocomplete="cc-exp"
                required
                title="Expiration date must be in MM/YY format"
        >
      </div>

      <div class="form-group">
        <label for="cvv">CVV</label>
        <input
                type="text"
                class="form-value"
                id="cvv"
                name="cvv"
                maxlength="4"
                pattern="\d{3,4}"
                placeholder="CVV"
                autocomplete="off"
                required
                title="CVV must be 3 or 4 digits"
                inputmode="numeric"
        >
      </div>
    </div>


    <div class="order-summary">
      <h3 style="text-align: center">Order Summary</h3>

      <div class="summary-table-container">
        <table class="summary-table">
          <thead>
          <tr>
            <th>Title</th>
            <th>Quantity</th>
            <th>Price</th>
          </tr>
          </thead>
          <tbody>
          <tr th:each="book : ${booksInCart}">
            <td th:text="${book.key.title}"></td>
            <td th:text="${book.value}"></td>
            <td th:text="'$' + (${book.key.price == book.key.price.intValue()} ? ${book.key.price.intValue()} : ${#numbers.formatDecimal(book.key.price, 1, 2)})"></td>
          </tr>
          </tbody>
        </table>
      </div>

      <div class="summary-total">
        <strong>Total:</strong>
        <strong th:text="'$' + (${totalPrice == totalPrice.intValue()} ? ${totalPrice.intValue()} : ${#numbers.formatDecimal(totalPrice, 1, 2)})"></strong>
      </div>

      <button type="submit" style="margin-top: 15px;">Place Order</button>
    </div>
  </form>
</div>

<div id="footer-root"></div>

<script th:src="@{/js/bundle.js}"></script>
</body>
</html>